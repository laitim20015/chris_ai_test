# {{ document.metadata.filename }}

{% if metadata %}
{{ metadata.to_yaml_frontmatter() }}

{% endif %}

## ğŸ“‹ æ–‡æª”æ¦‚è¦½

| é …ç›® | è©³æƒ… |
|------|------|
| ğŸ“„ åŸå§‹æ–‡ä»¶ | {{ document.metadata.filename }} |
| ğŸ“Š é æ•¸ | {{ document.metadata.page_count }} |
| ğŸ–¼ï¸ åœ–ç‰‡æ•¸é‡ | {{ document.images|length }} |
| ğŸ”— é—œè¯æ•¸é‡ | {{ associations|length }} |
| â±ï¸ è™•ç†æ™‚é–“ | {{ generation_time.strftime('%Y-%m-%d %H:%M:%S') }} |

---

## ğŸ“ æ–‡æª”å…§å®¹

{% for block_data in text_blocks_with_images %}
### æ®µè½ {{ loop.index }}

{{ block_data.text_block.content }}

{% if block_data.related_images %}
#### ğŸ“¸ ç›¸é—œåœ–ç‰‡

{% for image_data in block_data.related_images %}
<div class="image-association">

![{{ image_data.image.alt_text or 'Image' }}](./images/{{ image_data.image.filename or (image_data.image.id + '.png') }})

**åœ–ç‰‡ä¿¡æ¯:**
- ğŸ¯ é—œè¯åº¦: {{ "%.3f"|format(image_data.association.score) }}
- ğŸ“ é—œè¯é¡å‹: {{ image_data.association.association_type }}
- ğŸ” Captionæª¢æ¸¬: {{ 'âœ…' if image_data.association.caption_detected else 'âŒ' }}

</div>

{% endfor %}
{% endif %}

---

{% endfor %}

{% if tables %}
## ğŸ“Š æ•¸æ“šè¡¨æ ¼

{% for table in tables %}
### è¡¨æ ¼ {{ loop.index }}

{% if table.headers %}
| {{ table.headers|join(' | ') }} |
|{{ table.headers|map('replace', table.headers[0], ' --- ')|join('|') }}|
{% for row in table.rows[:10] %}
| {{ row|join(' | ') }} |
{% endfor %}

{% if table.rows|length > 10 %}
*è¨»: åƒ…é¡¯ç¤ºå‰10è¡Œæ•¸æ“š*
{% endif %}
{% endif %}

{% endfor %}
{% endif %}

---

## ğŸ” è™•ç†è©³æƒ…

{% if associations %}
### åœ–æ–‡é—œè¯åˆ†æ

| æ–‡æœ¬å¡Š | åœ–ç‰‡ | é—œè¯åº¦ | é¡å‹ | Caption |
|--------|------|--------|------|---------|
{% for assoc in associations %}
| {{ assoc.text_block_id }} | {{ assoc.image_id }} | {{ "%.3f"|format(assoc.score) }} | {{ assoc.association_type }} | {{ 'âœ…' if assoc.caption_detected else 'âŒ' }} |
{% endfor %}
{% endif %}

*Generated by æ™ºèƒ½æ–‡ä»¶è½‰æ›èˆ‡RAGçŸ¥è­˜åº«ç³»çµ± v{{ metadata.version if metadata else '1.0' }}*
