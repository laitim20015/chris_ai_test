# 智能文件轉換與RAG知識庫系統 - 環境變量配置模板
# 請複製此文件為 .env 並根據實際環境修改配置值

# ====== 應用程序基本配置 ======
APP_NAME="AP Project RAG System"
APP_VERSION="1.0.0"
APP_DESCRIPTION="智能文件轉換與RAG知識庫系統"
APP_DEBUG=false
APP_ENVIRONMENT="production"  # development, staging, production

# ====== 服務器配置 ======
HOST="0.0.0.0"
PORT=8000
WORKERS=4
RELOAD=false

# ====== 安全配置 ======
SECRET_KEY="your-super-secret-key-change-this-in-production"
API_KEY="your-api-key-for-external-access"
ACCESS_TOKEN_EXPIRE_MINUTES=30
ALLOWED_HOSTS="localhost,127.0.0.1,your-domain.com"
CORS_ORIGINS="http://localhost:3000,http://localhost:8080"

# ====== 文件處理配置 ======
# 文件大小限制 (MB)
MAX_FILE_SIZE=100
MAX_BATCH_SIZE=10
SUPPORTED_FORMATS="pdf,docx,pptx"

# 處理超時時間 (秒)
PROCESSING_TIMEOUT=300
UPLOAD_TIMEOUT=60

# ====== 圖片處理配置 ======
# 圖片質量和尺寸
IMAGE_QUALITY=85
MAX_IMAGE_WIDTH=1920
MAX_IMAGE_HEIGHT=1080
IMAGE_FORMAT="jpg"  # jpg, png, webp

# 圖片命名規範
IMAGE_NAMING_PATTERN="{filename}_{page}_{image_seq}_{timestamp}.{format}"

# ====== 存儲配置 ======
# 本地存儲
LOCAL_STORAGE_PATH="./data"
TEMP_STORAGE_PATH="./data/temp"
OUTPUT_STORAGE_PATH="./data/output"

# ====== 雲存儲配置 (可選) ======
# Azure Blob Storage
AZURE_STORAGE_ACCOUNT_NAME=""
AZURE_STORAGE_ACCOUNT_KEY=""
AZURE_CONTAINER_NAME="rag-documents"
AZURE_CDN_ENDPOINT=""

# AWS S3
AWS_ACCESS_KEY_ID=""
AWS_SECRET_ACCESS_KEY=""
AWS_REGION="us-east-1"
AWS_S3_BUCKET="rag-documents"
AWS_CLOUDFRONT_DOMAIN=""

# Google Cloud Storage
GOOGLE_CLOUD_PROJECT=""
GOOGLE_CLOUD_BUCKET="rag-documents"
GOOGLE_APPLICATION_CREDENTIALS="path/to/service-account.json"

# ====== 數據庫配置 ======
# Redis (緩存和會話)
REDIS_URL="redis://localhost:6379/0"
REDIS_PASSWORD=""
REDIS_DB=0

# PostgreSQL (可選，元數據存儲)
DATABASE_URL="postgresql://user:password@localhost:5432/rag_system"
DB_POOL_SIZE=10
DB_MAX_OVERFLOW=20

# ====== AI模型配置 ======
# Sentence Transformers
SENTENCE_TRANSFORMER_MODEL="all-MiniLM-L6-v2"
MODEL_CACHE_DIR="./data/models"
EMBEDDING_DIMENSION=384

# ====== 關聯分析配置 ======
# 評分權重 (必須嚴格遵循項目規則)
CAPTION_WEIGHT=0.4      # Caption檢測權重 (最高)
SPATIAL_WEIGHT=0.3      # 空間關係權重
SEMANTIC_WEIGHT=0.15    # 語義相似度權重
LAYOUT_WEIGHT=0.1       # 佈局模式權重
PROXIMITY_WEIGHT=0.05   # 距離權重

# 關聯度閾值
MIN_ASSOCIATION_SCORE=0.3
HIGH_CONFIDENCE_SCORE=0.8

# ====== 解析器配置 ======
# PDF解析器優先級 (嚴格按照項目規則)
PDF_PRIMARY_PARSER="pymupdf"        # PyMuPDF (最快)
PDF_MARKDOWN_PARSER="pymupdf4llm"   # 最佳Markdown輸出
PDF_SEMANTIC_PARSER="unstructured"  # 語義分塊

# 解析器超時
PDF_PARSE_TIMEOUT=120
WORD_PARSE_TIMEOUT=60
PPT_PARSE_TIMEOUT=90

# ====== Markdown生成配置 ======
MARKDOWN_TEMPLATE="enhanced"  # basic, enhanced
INCLUDE_METADATA=true
INCLUDE_IMAGE_CAPTIONS=true
MARKDOWN_LINE_BREAK_STYLE="standard"  # standard, github

# ====== 知識庫集成配置 ======
# Azure AI Search
AZURE_SEARCH_SERVICE_NAME=""
AZURE_SEARCH_API_KEY=""
AZURE_SEARCH_INDEX_NAME="rag-documents"

# 分塊策略
CHUNK_SIZE=1000
CHUNK_OVERLAP=200
CHUNKING_STRATEGY="semantic"  # fixed, semantic, hybrid

# ====== 監控和日誌配置 ======
# 日誌級別
LOG_LEVEL="INFO"  # DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_FORMAT="json"  # text, json
LOG_FILE_PATH="./logs/app.log"
LOG_ROTATION="1 week"
LOG_RETENTION="30 days"

# 監控
ENABLE_METRICS=true
METRICS_PORT=9090
HEALTH_CHECK_PATH="/health"

# ====== 性能配置 ======
# 並發處理
MAX_CONCURRENT_PROCESSING=5
ENABLE_PARALLEL_PROCESSING=true

# 緩存配置
ENABLE_CACHING=true
CACHE_TTL=3600  # 1小時
CACHE_MAX_SIZE=1000

# ====== 開發和測試配置 ======
# 開發模式
DEVELOPMENT_MODE=false
ENABLE_DEBUG_ENDPOINTS=false
MOCK_EXTERNAL_SERVICES=false

# 測試配置
TEST_DATA_PATH="./tests/fixtures"
ENABLE_TEST_MODE=false

# ====== API限流配置 ======
RATE_LIMIT_ENABLED=true
RATE_LIMIT_REQUESTS_PER_MINUTE=60
RATE_LIMIT_BURST=10

# ====== 外部服務配置 ======
# 如果使用外部OCR服務
EXTERNAL_OCR_API_KEY=""
EXTERNAL_OCR_ENDPOINT=""

# 如果使用外部AI服務
OPENAI_API_KEY=""
HUGGINGFACE_API_KEY=""

# ====== 部署配置 ======
# Docker
CONTAINER_NAME="ap-rag-system"
DOCKER_NETWORK="rag-network"

# Kubernetes
K8S_NAMESPACE="rag-system"
K8S_CONFIG_PATH="./deploy/k8s"

# 注意事項：
# 1. 生產環境中務必更改所有密鑰和敏感信息
# 2. 權重配置必須嚴格遵循項目規則，總和為1.0
# 3. 存儲路徑確保有適當的讀寫權限
# 4. 雲服務配置僅在使用相應服務時填寫
# 5. 所有布爾值使用小寫：true/false

